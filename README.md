# sparkNLP
基于spark的NLP应用

一 新词发现

主要实现点：左邻右邻信息熵， 点间互信息， Ngram

==> 后续会考虑重合子串的处理

调用方式：
    
    import cn.spark.nlp.newwordfind._
    
    def main(args: Array[String]): Unit = {
        val conf = new SparkConf()
          .setAppName("new-words-find")
          .setMaster("local[3]")
    
        val pattern = "[\u4E00-\u9FA5]+".r
        val stopwords = "[你|我|他|她|它]+"
    
        val minLen = 2
        val maxLen = 6
        val minCount = 20
        val minInfoEnergy = 2.0
        val minPim = 300.0
        val numPartition = 6
    
        val newWordFindConfig = NewWordFindConfig(minLen, maxLen,
          minCount, minInfoEnergy, minPim, numPartition)
    
        val sc = new SparkContext(conf)
        
        val lines =sc.textFile("/Users/songyaheng/Downloads/西游记.txt")
          .flatMap(pattern.findAllIn(_).toSeq)
          .flatMap(_.split(stopwords))
          .newWord(sc, newWordFindConfig)
          .map(wepf => (wepf._2 * wepf._3 * wepf._4, wepf._1))
          .sortByKey(false, 1)
          .foreach(println)
    
        sc.stop()
      }
      
结果如下：

        (2129007.2276846156,袈裟)
        (2075637.3583328482,芭蕉)
        (1968505.733623468,吩咐)
        (1908369.3526295517,菩萨)
        (1891599.6268979784,葫芦)
        (1531062.1474128726,和尚)
        (1371297.8983705256,乾坤)
        (1362615.585323924,哪吒)
        (1342596.4204241643,猢狲)
        (1205283.8989004644,琉璃)
        (908959.6944964001,荆棘)
        (860129.3402594561,包袱)
        (849672.012686538,校尉)
        (837562.3751032043,模样)
        (805832.8362465773,钵盂)
        (793493.7218721949,什么)
        (754799.3338208644,宝贝)
        (719637.3683307616,揭谛)
        (714550.2433543804,惫懒)
        (712197.6388383985,仔细)
        (607218.5014457502,兵器)
        (535252.6063829504,苍蝇)
        (515408.48502730636,弼马温)
        (508393.3234108873,左右)
        (493196.9516247795,抖擞)
        (462227.96138300555,钉钯)
        (452984.3735813065,孽畜)
        (446041.49754355394,驿丞)
        (414376.88495046936,毫毛)
        (409205.2968092681,衣服)
        (394850.11010440113,夯货)
        (387401.4079701623,铁棒)
        (376129.0135961126,悚惧)
        (366458.2329014657,耳朵)
        (365362.75514706,烦恼)
        (363770.4615312989,祭赛)
        (359368.41119986534,收拾)
        (357561.6547171945,武艺)
        (351163.2327764569,丑陋)
        (337764.36929271993,慈悲)
        (330678.6981251516,怠慢)
        (326875.2240003128,蟠桃)
        (317182.42278188,逍遥)
        (312295.76383530116,罗刹)
        (311896.20316620544,伺候)
        (297930.25668832654,计较)
        (291371.80805718875,欢喜)
        (287976.1424756704,公主)
        (284621.23656028975,输赢)
        (276229.92292721185,吆喝)
        (271683.23374274845,纷纷)
        (271180.5116522583,奶奶)
        (270670.2905464076,妈妈)
        (260832.37979852047,壁厢)
        (258158.7129405828,悟空)
        (252884.6653430898,安排)
        (252625.87214331282,比丘)
        (240384.02301803563,东土)
        (236913.09875903843,尘埃)
        (223925.0624756318,呵呵)
        (217979.0600522209,性命)